
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
  
    <script>
        // JavaScript Document
        
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-19660825-1']);
        _gaq.push(['_setDomainName', 'dynamsoft.com']);
        _gaq.push(['_trackPageview']);
        (function () {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <script type="text/javascript">
        window.history.forward();
        function noBack() { window.history.forward(); }

    </script>
</head>

<body onpageshow="if (event.persisted) noBack();" onunload="">
   
    <div id="container" class="body_Broad_width" style="margin:0 auto;">
        
        <div class="DWTHeader">
            <!-- header.aspx is used to initiate the head of the sample page. Not necessary!-->
            <!-- #include file=includes/PageHead.aspx -->
           
        </div>

        <div id="DWTcontainer" class="body_Broad_width" style="background-color:#ffffff; height:900px; border:0;">

            <div id="dwtcontrolContainer" style="height:605px;"></div>
            <div id="DWTNonInstallContainerID" style="width:580px"></div>
            <div id="DWTemessageContainer" style="margin-left:50px;width:580px"></div>

            <div id="ScanWrapper">
                
                <div id="divScanner" class="divinput">
                    <div style="padding-bottom: 10px; padding-left: 112px;">
                        <input id='btnbacklist' type='button' class="btn btn-success" onclick='btnback_onclick()' value='Close' />
                    </div>
                    <ul class="PCollapse">
                        <li>
                            <div class="divType"><div class="mark_arrow expanded"></div>Associate With</div>
                            <div id="div_SampleImage"  class="divTableStyle">
                                <ul>
                                    
                                  
                                    <li>
                                        <div class="form-group">
                                           
                                            <div class="col-md-2">
                                              
                                                <input id="RadioUser" type="radio" name="AW" checked="checked" />
                                                <label for="User">User</label>

                                                <input id="RadioPatient" type="radio" name="AW" />
                                                <label for="Patient">Patient</label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <select id="User" class="HideDDl">
                                                <option>Select User</option>

                                            </select>
                                            <select id="Patient" class="HideDDl">
                                                <option>Select Patient</option>

                                            </select>
                                            </div>
</li>
                                </ul>
                            </div>
                        </li>
                        <li>
                            <div class="divType"><div class="mark_arrow collapsed"></div>Custom Scan</div>
                            <div id="div_ScanImage" style="display: none" class="divTableStyle">
                                <ul id="ulScaneImageHIDE">
                                    <li style="padding-left: 15px;">
                                        <label for="source">Select Source:</label>
                                        <select size="1" id="source" style="position:relative;width: 220px;" onchange="source_onchange()">
                                            <option value=""></option>
                                        </select>
                                    </li>
                                    <li style="display:none;" id="pNoScanner">
                                        <a href="javascript: void(0)" class="ShowtblLoadImage" style="font-size: 11px; background-color:#f0f0f0; position:relative" id="aNoScanner">
                                            <b>What if I don't have a scanner/webcam connected?</b>
                                        </a>
                                    </li>
                                    <li id="divProductDetail"></li>
                                    <li style="text-align:center;">
                                        <input id="btnScan" class="bigbutton" style="color:#C0C0C0;" disabled="disabled" type="button" value="Scan" onclick="acquireImage();" />
                                    </li>
                                </ul>
                            </div>
                        </li>
                        
                        <li>
                            <div class="divType"><div class="mark_arrow collapsed"></div>Load a Local Image</div>
                            <div id="div_LoadLocalImage" style="display: none" class="divTableStyle">
                                <ul>
                                    <li style="text-align: center; height:35px; padding-top:8px;">
                                        <input type="button" value="Load Image" style="width: 130px; height:30px; font-size:medium;" onclick="return btnLoad_onclick()" />
                                    </li>
                                </ul>
                            </div>
                        </li>

                    </ul>

                </div>

                <div id="divBlank" style="height:20px">
                    <ul>
                        <li></li>
                    </ul>
                </div>

                <div id="tblLoadImage" style="visibility:hidden;height:80px">
                    <ul>
                        <li><b>You can:</b><a href="javascript: void(0)" style="text-decoration:none; padding-left:200px" class="ClosetblLoadImage">X</a></li>
                    </ul>
                    <div id="notformac1" style="background-color:#f0f0f0; padding:5px;">
                        <ul>
                            <li><img alt="arrow" src="~/Areas/Scan/Images/" width="9" height="12" /><b>Install a Virtual Scanner:</b></li>
                            <li style="text-align:center;">
                                <a id="samplesource32bit" href="http://www.dynamsoft.com/demo/DWT/Sources/twainds.win32.installer.2.1.3.msi">32-bit Sample Source</a>
                                <a id="samplesource64bit" style="display:none;" href="http://www.dynamsoft.com/demo/DWT/Sources/twainds.win64.installer.2.1.3.msi">64-bit Sample Source</a>
                                from <a href="http://www.twain.org">TWG</a>
                            </li>
                        </ul>
                    </div>
                </div>

                <div id="divEdit" class="divinput" style="position:relative">
                    <ul>
                        <li><img alt="arrow" src="~/Areas/Scan/Images/arrow.gif" width="9" height="12" /><b>Edit Image</b></li>
                        <li style="padding-left:9px;">
                            <img src="~/Areas/Scan/Images/ShowEditor.png" title="Show Image Editor" alt="Show Image Editor" id="btnEditor" onclick="btnShowImageEditor_onclick()" />
                            <img src="~/Areas/Scan/Images/RotateLeft.png" title="Rotate Left" alt="Rotate Left" id="btnRotateL" onclick="btnRotateLeft_onclick()" />
                            <img src="~/Areas/Scan/Images/RotateRight.png" title="Rotate Right" alt="Rotate Right" id="btnRotateR" onclick="btnRotateRight_onclick()" />
                            <img src="~/Areas/Scan/Images/Rotate180.png" alt="Rotate 180" title="Rotate 180" onclick="btnRotate180_onclick()" />
                            <img src="~/Areas/Scan/Images/Mirror.png" title="Mirror" alt="Mirror" id="btnMirror" onclick="btnMirror_onclick()" />
                            <img src="~/Areas/Scan/Images/Flip.png" title="Flip" alt="Flip" id="btnFlip" onclick="btnFlip_onclick()" />
                            <img src="~/Areas/Scan/Images/ChangeSize.png" title="Change Image Size" alt="Change Image Size" id="btnChangeImageSize" onclick="btnChangeImageSize_onclick();" />
                            <img src="~/Areas/Scan/Images/Crop.png" title="Crop" alt="Crop" id="btnCrop" onclick="btnCrop_onclick();" />
                        </li>
                    </ul>

                </div>


                <div id="divUpload" class="divinput" style="position:relative">
                    <ul>
                        <li><img alt="arrow" src="~/Areas/Scan/Images/arrow.gif" width="9" height="12" /><b>Save Records</b></li>
                        <li style="padding-left:9px;">
                            <label for="txt_fileName">File Name: <input type="text" size="20" id="txt_fileName" /></label>
                        </li>
                        <li style="padding-left:9px;">
                            <label for="imgTypejpeg2">
                                <input type="radio" value="jpg" name="ImageType" id="imgTypejpeg2" onclick="rd_onclick();" />JPEG
                            </label>
                            <label for="imgTypetiff2">
                                <input type="radio" value="tif" name="ImageType" id="imgTypetiff2" onclick="rdTIFF_onclick();" />TIFF
                            </label>
                            <label for="imgTypepng2">
                                <input type="radio" value="png" name="ImageType" id="imgTypepng2" onclick="rd_onclick();" />PNG
                            </label>
                            <label for="imgTypepdf2">
                                <input type="radio" value="pdf" name="ImageType" id="imgTypepdf2" onclick="rdPDF_onclick();" />PDF
                            </label>
                        </li>
                        <li style="padding-left:9px;">
                            <label for="MultiPageTIFF"><input type="checkbox" id="MultiPageTIFF" />Multi-Page TIFF</label>
                            <label for="MultiPagePDF"><input type="checkbox" id="MultiPagePDF" />Multi-Page PDF </label>
                        </li>
                        <li style="text-align: center">
                            <input id="btnUpload" type="button" value="Save" onclick="btnUpload1_onclick()" />
                            @*btnUpload_onclick()  *@
                        </li>
                    </ul>
                    @*HiddenField For Set User Type*@
                    <input id="HiddenTypeID" type="hidden" />
                    <input id="HiddenType" type="hidden" />

                </div>

                <div id="divSave" class="divinput" style="position:relative;display:none;">
                    <ul>
                        <li><img alt="arrow" src="~/Areas/Scan/Images/arrow.gif" width="9" height="12" /><b>Save Image</b></li>
                        <li style="padding-left:15px;">
                            <label for="txt_fileNameforSave">File Name: <input type="text" size="20" id="txt_fileNameforSave" /></label>
                        </li>
                        <li style="padding-left:12px;">
                            <label for="imgTypebmp">
                                <input type="radio" value="bmp" name="imgType_save" id="imgTypebmp" onclick="rdsave_onclick();" />BMP
                            </label>
                            <label for="imgTypejpeg">
                                <input type="radio" value="jpg" name="imgType_save" id="imgTypejpeg" onclick="rdsave_onclick();" />JPEG
                            </label>
                            <label for="imgTypetiff">
                                <input type="radio" value="tif" name="imgType_save" id="imgTypetiff" onclick="rdTIFFsave_onclick();" />TIFF
                            </label>
                            <label for="imgTypepng">
                                <input type="radio" value="png" name="imgType_save" id="imgTypepng" onclick="rdsave_onclick();" />PNG
                            </label>
                            <label for="imgTypepdf">
                                <input type="radio" value="pdf" name="imgType_save" id="imgTypepdf" onclick="rdPDFsave_onclick();" />PDF
                            </label>
                        </li>
                        <li style="padding-left:12px;">
                            <label for="MultiPageTIFF_save"><input type="checkbox" id="MultiPageTIFF_save" />Multi-Page TIFF</label>
                            <label for="MultiPagePDF_save"><input type="checkbox" id="MultiPagePDF_save" />Multi-Page PDF </label>
                        </li>
                        <li style="text-align: center">
                            <input id="btnSave" type="button" value="Save Image" onclick="btnSave_onclick()" />
                        </li>
                    </ul>
                </div>

            

            </div>

        </div>

        <div class="DWTTail">
            <!-- #include file=includes/PageTail.aspx -->
        </div>



    </div>

    <div id="ImgSizeEditor" style="visibility:hidden; text-align:left;">
        <ul>
            <li>
                <label for="img_height">
                    <b>New Height :</b>
                    <input type="text" id="img_height" style="width:50%;" size="10" />pixel
                </label>
            </li>
            <li>
                <label for="img_width">
                    <b>New Width :</b>&nbsp;
                    <input type="text" id="img_width" style="width:50%;" size="10" />pixel
                </label>
            </li>
            <li>
                Interpolation method:
                <select size="1" id="InterpolationMethod"><option value=""></option></select>
            </li>
            <li style="text-align:center;">
                <input type="button" value="   OK   " id="btnChangeImageSizeOK" onclick="btnChangeImageSizeOK_onclick();" />
                <input type="button" value=" Cancel " id="btnCancelChange" onclick="btnCancelChange_onclick();" />
            </li>
        </ul>
    </div>
    <div class="narrow-screen">
        <div class="tips-header"><a href="http://www.dynamsoft.com/Products/WebTWAIN_Overview.aspx"><img src="images/DWT icon logo.png" border="0" /></a><h1>Online Demo</h1></div>
        <div class="tips-desktop"><img src="images/sc-desktop-only.png" border="0" alt="" width="280" /></div>
        <p class="tips">Sorry! <br /> Please visit this page in your desktop web browsers. Thanks! </p>
    </div>
    
    <script type="text/javascript" language="javascript" src="~/Areas/Scan/Resources/dynamsoft.webtwain.initiate.js"></script>
    <script type="text/javascript" language="javascript" src="~/Areas/Scan/Resources/dynamsoft.webtwain.config.js"></script>
    <script type="text/javascript" language="javascript" src="~/Areas/Scan/js/online_demo_operation.js"></script>
    <script type="text/javascript" language="javascript" src="~/Areas/Scan/js/online_demo_initpage.js"></script>
    <script type="text/javascript" language="javascript" src="~/Areas/Scan/js/jquery.js"></script>

    @*<div id='loadingmessage' class="loader fade" style="display:none;">
        <img src='~/Areas/ScreenPermissions/Images/loading2.gif' style="height: 150px;width: 200px;" />
    </div>*@
    <link href="~/Areas/Scan/Styles1/style.css" rel="stylesheet" />
    @*<script src="~/Scripts/DWTSample_ScanAndUpload.js"></script>
        <script src="~/js/jquery.js"></script>*@
    <script type="text/javascript">
        $("ul.PCollapse li>div").click(function () {
            if ($(this).next().css("display") == "none") {
                $(".divType").next().hide("normal");
                $(".divType").children(".mark_arrow").removeClass("expanded");
                $(".divType").children(".mark_arrow").addClass("collapsed");
                $(this).next().show("normal");
                $(this).children(".mark_arrow").removeClass("collapsed");
                $(this).children(".mark_arrow").addClass("expanded");
            }
        });
        $(document).ready(function () {
            //if ($("#HiddenEditMode").val() != "") {
            //    // setInterval(function () { ShowImagesInCanvas(); }, 1000);
            //    ShowImagesInCanvas();
            //}
            $("#User").addClass("ShowDDl");
            $("#User").removeClass("HideDDl");
            $("#RadioUser").change(function () {
                $("#User").addClass("ShowDDl");
                $("#User").removeClass("HideDDl");
                $("#Patient").addClass("HideDDl");
            })
            $("#RadioPatient").change(function () {
                $("#Patient").addClass("ShowDDl");
                $("#Patient").removeClass("HideDDl");
                $("#User").addClass("HideDDl");
                var Value = $("#User option:selected").val();
               // alert(Value);
            })

            //Fill Selected Value
            $("#User").change(function () {
             
                var Value = $("#User option:selected").val();
                if (Value != "Select a User") {
                  
                    $("#HiddenTypeID").val(Value);
                    $("#HiddenType").val("U");
                }
            })
            //
            $("#Patient").change(function () {

                var Value = $("#Patient option:selected").val();
                if (Value != "Select a Patient")
                {
                    $("#HiddenTypeID").val(Value);
                    $("#HiddenType").val("P");
                   
                }
                
            })
            //End

            //Bind All Users
            $(function () {
                $('#User').html('');
                $.getJSON('/Scan/Home/GetAllUsers', function (data) {
                    var items = '<option>Select a User</option>';
                    $.each(data, function (i, User) {
                        items += "<option value='" + User.value + "'>" + User.text + "</option>";
                    });
                    $('#User').html(items);
                });
               
            });
            //End

            // Bind All Patient
            $(function () {
                $('#Patient').html('');
                $.getJSON('/Scan/Home/GetAllPatient', function (data) {
                    var items = '<option>Select a Patient</option>';
                    $.each(data, function (i, User) {
                        items += "<option value='" + User.value + "'>" + User.text + "</option>";
                    });
                    $('#Patient').html(items);
                });

            });
            //End
        });

    </script>
    <script type="text/javascript" language="javascript">
        // Assign the page onload fucntion.
        $(function () {
            pageonload();
        });

        $('#DWTcontainer').hover(function () {
            $(document).bind('mousewheel DOMMouseScroll', function (event) {
                stopWheel(event);
            });
        }, function () {
            $(document).unbind('mousewheel DOMMouseScroll');
        });

        


    </script>
    <style>
        .ShowDDl {
            display: inline-block;
            width: 75%;
        }
        .HideDDl {
            display:none;

        }

    </style>
    <style>
        .loader {
            position: absolute;
            top: 8%;
            left: 5%;
            width: 400px;
            height: 200px;
            padding: 30px 15px 0px;
            border: 3px solid #ababab;
            box-shadow: 1px 1px 10px #ababab;
            border-radius: 20px;
            background-color: white;
            z-index: 1002;
            text-align: center;
            overflow: auto;
        }

        .fade {
            position: absolute;
            top: 0%;
            left: 0%;
            width: 100%;
            height: 100%;
            background-color: #ababab;
            z-index: 1001;
            -moz-opacity: 0.8;
            opacity: .70;
            filter: alpha(opacity=80);
        }

        .table {
            width: 100%;
            margin-bottom: 20px;
            margin-top: 20px;
        }

        .delHide {
            display: none;
        }

        .delShow {
            display: inline-block;
            
        }
    </style>
    
    <div id='loadingmessage' class="loader fade" style="display: none; z-index: 7000; height: 95%; width: 90%; margin-left: 4%; ">
        <img src='~/Areas/ScreenPermissions/Images/loading2.gif' style="height: 50px;width: 50px;" />
    </div>
    <input id="HiddenEditMode" type="hidden" value="@ViewBag.EditMode" />
    <script type="text/javascript" language="javascript">
        // Assign the page onload fucntion.
        $(function () {
            pageonload();
        });

        $('#DWTcontainer').hover(function () {
            $(document).bind('mousewheel DOMMouseScroll', function (event) {
                stopWheel(event);
            });
        }, function () {
            $(document).unbind('mousewheel DOMMouseScroll');
        });
        var data;
        function ShowImagesInCanvas() {
            $("#loadingmessage").show();
            $.ajax({
                type: "POST",
                url: "/Scan/Home/GetAllImagesByScannedRecordID",
                data: '{ScannedRecordID: ' + $("#HiddenEditMode").val() + '}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    //setInterval(function () { LoadImagesInEditMode(data); }, 2);
                    //  $("#loadingmessage").show();
                    //debugger;
                    if (data.length > 0) {
                        //  alert("FillData");
                        if (data[0].Type == "U") {
                            $("#User").val(data[0].AssociatedWith);
                            $("#User").addClass("ShowDDl");
                            $("#User").removeClass("HideDDl");
                            $("#Patient").addClass("HideDDl");
                            $('#RadioUser').attr('checked', true);
                            $('#RadioPatient').attr('checked', false);
                            $("#HiddenTypeID").val(data[0].AssociatedWith);
                            $("#HiddenType").val("U");
                        }
                        else {
                            $("#Patient").val(data[0].AssociatedWith);
                            $("#Patient").addClass("ShowDDl");
                            $("#Patient").removeClass("HideDDl");
                            $("#User").addClass("HideDDl");
                            $('#RadioUser').attr('checked', false);
                            $('#RadioPatient').attr('checked', true);
                            $("#HiddenTypeID").val(data[0].AssociatedWith);
                            $("#HiddenType").val("P");

                        }
                    }
                    // $("#User").triggerHandler()
                    LoadImagesInEditMode(data);
                    //data = data;
                    $("#loadingmessage").hide();
                },
                failure: function (response) {
                    alert(response.d);
                }
            });
        }
        function pageonloadForView() {
           // initMessageBox(true);
        }

        //function Dynamsoft_OnReady() {
        //    // If the ErrorCode is 0, it means everything is fine for the control. It is fully loaded.
        //    //alert("load");
        //    DWObject = Dynamsoft.WebTwainEnv.GetWebTwain('dwtcontrolContainer');
        //    if (DWObject) {
        //        if (DWObject.ErrorCode == 0) {
        //            //if ($("#HiddenEditMode").val() != "") {
        //            //    // setInterval(function () { ShowImagesInCanvas(); }, 1000);
        //            //    ShowImagesInCanvas();
        //            //}
      
        //        }
        //    }
        //}
        $(function () {
            //pageonloadForView();
        });
     
    </script>


</body>
</html>


